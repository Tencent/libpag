---
description: 编码规范
alwaysApply: true
---

## 编码规范

- 对话用中文，代码和注释用英语
- 所有说明文件、方案设计文件统一放在 `.codebuddy/designs/` 目录（已加入 .gitignore，不参与提交）
- 新需求禁止直接编码，先输出详细方案设计文件，穷尽疑问向用户提问，用户明确确认后再按方案编码
- 复用项目已有功能，保持变更简洁，避免重复代码
- 重构时审查关联代码合理性，顺带清理冗余，不考虑向后兼容
- 版权声明里的年份对新增的文件要使用当前年份（如 `Copyright (C) 2026 Tencent`），已有文件保持原年份不变
- 驼峰命名法：大写开头（类静态方法、全局函数/变量）、小写开头（成员方法/变量、局部变量）、全大写下划线（静态常量）
- 变量命名避免缩写，简短且语义明确
- 变量声明时一律赋初始值（即使是 `={}`），智能指针初始值使用 nullptr
- 避免 lambda 表达式，改用显式方法或函数
- 禁止使用 `dynamic_cast` 和 C++ 异常（`throw`/`try`/`catch`）
- 尽量避免声明 mutable 声明变量，有线程安全问题，应该把调用的方法去掉 const
- CPP 文件里的函数实现顺序与头文件中定义的顺序尽可能一致
- `include/` 目录 API 需详细注释含参数描述，其他公开方法一段话描述主要功能，私有方法不加注释
- 函数内代码不加行注释，除非只看代码无法理解设计意图
- 对于 vector 能预知大小时，使用 `reserve` 提前分配内存避免动态扩容
- 未明确的规范，模仿项目已有风格
